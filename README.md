# STM32F4-Qt-Monitor

## Remote fire and theft prevention monitor based on STM32F4, and upper computer designed by QT

## 基于STM32F4的防火防盗远程监测器

一、基于领取的硬件材料，设计一个具有温度、震动、姿态监测报警，并能进行远程通信的监测器。

    功能1：系统上电启动时，在OLED屏上显示选题名称，2秒后如图显示学号姓名，再保持3秒后进入主菜单。 整个启动过程，8个LED灯秒闪提示系统正在启动，进入主菜单界面后8个LED灯熄灭，蜂鸣器鸣叫1声提示启动完成。 启动过程中，可以直接按K5按键进入主菜单。 主菜单界面中，可以按K6按键返回启动界面。

    功能2：进入主菜单界面后，默认显示监测主界面内容。 整个界面左侧是功能菜单，包括“实时监测”、 “数据曲线”、“无线通信”和“参数设置”四个子菜单。 用户可以通过开发板左侧四个独立按键切换菜单和左右翻页。 实时监测菜单下，第1页显示当前温度、震动报警信息，第2页显示三 轴加速值，第3页显示三轴角速度值。 当温度超过报警阀值或者传感器加速度超过某个阀值时，4位数码 管显示30秒倒计时，该时间段内按键功能无效。

    功能3：数据曲线。显示温度动态曲线和6轴传感器的3个姿态角动态数据曲线（用K2、K3切换显示不同的数据曲线），K5按键切换记录数据点间隔时间（50ms一个数据点或者1秒一个数据点） 温度曲线图中，可以用水平虚线表示温度报警阀值。

    功能4：无线通信。进入该功能后，定时自动连接远程TCP服务器并进入透传模式。连接成功后，使用K2开启/K3关闭数据上传功能，上传数据包括温度数值、3轴加速度和3轴角速度、三个姿态角、报警信息。 OLED屏显示如下： 显示内容包括：ESP8266模块SSID、 服务器IP地址 、端口，服务器连接状态（ok、error）、 数据上传状态 （上传中、已关闭）。 

    如果使用蓝牙模块通信，定时检测蓝牙连接状态。当蓝牙已连接， 使用K2开启/K3关闭数据上传功能。显示内容包括蓝牙名称、蓝牙连接状态、数据上传状态。

    功能5：参数设置页面。在该页面中，显示“温度上限” 、“震动灵敏度”、“报警时长”和“上传间隔”这4个参数。 在该页面中，按K5切换当前要修改的参数，按K2、K3对当前参数进行加、减操作。 

              温度上限可调范围：0～90℃ 。
  
              震动灵敏度可调范围：0～9级，0表示不检测，灵敏度越大，震动检测越灵敏，灵敏度越小，震动检测越不灵敏。

              报警时长可调范围：0～60秒，0表示不报警。

              上传间隔可调范：100ms～10秒。

二 配合监测器，设计一个PC端或手机端的上位机 软件，可以接收查看远程监测器实时数据、状 态曲线和报警记录，并具有下发设置参数、清 除报警等功能。

    上位机设计要求1： 编程语言和开发工具不限，验收测试时需提供程序源代码，并现场编译运行。 上位机通过无线通信方式接收下位机上传数据，能从接收数据中提 取出温度、三轴加速度、三轴角速度、三个姿态角、报警信息和设 置参数等数据，并将其显示在窗口界面的不同组件中。 

    上位机设计要求2： 上位机窗口界面中除了提供“温度上限”、“震动灵敏度”、“报 警时长”、“上传时间间隔”四个系统参数的显示和设置下发功能， 还应提供“启动/关闭上传”按钮用来控制数据上传功能。

三、扩展设计

    扩展设计1：在显示学号姓名保持3秒后显示组内成员大头照，要求 大头照为自己制作的真人头像，脸部细节清晰可辨认。

    扩展设计2：出现报警时，添加蜂鸣器声音报警，且温度报警和震动报警的声音、样式不同，报警时间段内，必须同时按下K1、K2、 K3、K4并保持3秒才能关闭报警。

    扩展设计3：添加一个页面，以3D立体示意图的方式，实时显示当前传感器姿态。

    扩展设计4：添加一个页面，显示发送、接收数据的字节数统计信息，按K5清零。并且，给发送和接收数据添加LED闪烁指示。

    上位机扩展设计1： 接收并存储下位机上传数据，实现历史数据保存和读取功能，并能绘制“温度”、“三轴加速度”、“三轴角速度”和“三个姿态角”的数据曲线。实时查看当前数据时，数据曲线应该能自动刷新滚动。 

    上位机扩展设计2： 使用Android Studio或Qt for Android版本或App Inventor软件，移植或设计手机端上位机App程序，实现在手机端运行上位机基本功能。 

    上位机扩展设计3： 下位机和上位机不通过TCP客户端/服务器模式通信，使用移动OneNet或阿里云等物联网实现云端数据存储、App远程查看、参数设置等功能。
